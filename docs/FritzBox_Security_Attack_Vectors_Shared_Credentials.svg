<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="776px" preserveAspectRatio="none" style="width:915px;height:776px;background:#FFFFFF;" version="1.1" viewBox="0 0 915 776" width="915px" zoomAndPan="magnify"><title>Security Attack Vectors: Shared Credentials</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="546.9492" x="182.6477" y="35.4209">Security Attack Vectors: Shared Credentials</text><g><title>Host</title><rect fill="#FFFFFF" height="61.2656" style="stroke:#000000;stroke-width:1;" width="10" x="234.271" y="203.1719"/></g><g><title>.env File</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="333.9326" y="232.3047"/></g><g><title>Docker</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="432.251" y="582.7656"/></g><g><title>Fritzbox 1</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="535.8262" y="296.5703"/></g><g><title>Fritzbox 2</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="649.457" y="360.8359"/></g><g><title>Fritzbox 3</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="763.0879" y="425.1016"/></g><g><title>Attacker</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="45.6543" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="49" x2="49" y1="128.9063" y2="695.2969"/></g><g><title>Host</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="235.271" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="239.168" x2="239.168" y1="128.9063" y2="695.2969"/></g><g><title>.env File</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="334.9326" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="338.374" x2="338.374" y1="128.9063" y2="695.2969"/></g><g><title>Docker</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="433.251" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="436.4912" x2="436.4912" y1="128.9063" y2="695.2969"/></g><g><title>Fritzbox 1</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="536.8262" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="540.0107" x2="540.0107" y1="128.9063" y2="695.2969"/></g><g><title>Fritzbox 2</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="650.457" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="653.6416" x2="653.6416" y1="128.9063" y2="695.2969"/></g><g><title>Fritzbox 3</title><rect fill="#000000" fill-opacity="0.00000" height="566.3906" width="8" x="764.0879" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="767.2725" x2="767.2725" y1="128.9063" y2="695.2969"/></g><g class="participant participant-head" data-participant="Attacker"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.3086" x="17" y="125.6045">Attacker</text><ellipse cx="49.6543" cy="60.6094" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M49.6543,68.6094 L49.6543,95.6094 M36.6543,76.6094 L62.6543,76.6094 M49.6543,95.6094 L36.6543,110.6094 M49.6543,95.6094 L62.6543,110.6094" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="Attacker"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.3086" x="17" y="707.292">Attacker</text><ellipse cx="49.6543" cy="719.5938" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M49.6543,727.5938 L49.6543,754.5938 M36.6543,735.5938 L62.6543,735.5938 M49.6543,754.5938 L36.6543,769.5938 M49.6543,754.5938 L62.6543,769.5938" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="Host"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="66.2061" x="206.168" y="81.3125"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.876" x="223.333" y="101.3076">Host</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52.2061" x="213.168" y="117.6045">System</text></g><g class="participant participant-tail" data-participant="Host"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="66.2061" x="206.168" y="694.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.876" x="223.333" y="714.292">Host</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52.2061" x="213.168" y="730.5889">System</text></g><g class="participant participant-head" data-participant="Env"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="73.1172" x="302.374" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.1172" x="309.374" y="117.6045">.env File</text></g><g class="participant participant-tail" data-participant="Env"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="73.1172" x="302.374" y="694.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.1172" x="309.374" y="714.292">.env File</text></g><g class="participant participant-head" data-participant="Docker"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="63.5195" x="405.4912" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.5195" x="412.4912" y="117.6045">Docker</text></g><g class="participant participant-tail" data-participant="Docker"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="63.5195" x="405.4912" y="694.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.5195" x="412.4912" y="714.292">Docker</text></g><g class="participant participant-head" data-participant="FB1"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.6309" x="499.0107" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.6309" x="506.0107" y="117.6045">Fritzbox 1</text></g><g class="participant participant-tail" data-participant="FB1"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.6309" x="499.0107" y="694.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.6309" x="506.0107" y="714.292">Fritzbox 1</text></g><g class="participant participant-head" data-participant="FB2"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.6309" x="612.6416" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.6309" x="619.6416" y="117.6045">Fritzbox 2</text></g><g class="participant participant-tail" data-participant="FB2"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.6309" x="612.6416" y="694.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.6309" x="619.6416" y="714.292">Fritzbox 2</text></g><g class="participant participant-head" data-participant="FB3"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.6309" x="726.2725" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.6309" x="733.2725" y="117.6045">Fritzbox 3</text></g><g class="participant participant-tail" data-participant="FB3"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.6309" x="726.2725" y="694.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.6309" x="733.2725" y="714.292">Fritzbox 3</text></g><g><title>Host</title><rect fill="#FFFFFF" height="61.2656" style="stroke:#000000;stroke-width:1;" width="10" x="234.271" y="203.1719"/></g><g><title>.env File</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="333.9326" y="232.3047"/></g><g><title>Docker</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="432.251" y="582.7656"/></g><g><title>Fritzbox 1</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="535.8262" y="296.5703"/></g><g><title>Fritzbox 2</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="649.457" y="360.8359"/></g><g><title>Fritzbox 3</title><rect fill="#FFFFFF" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="763.0879" y="425.1016"/></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="903.2446" x="5" y="159.4727"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="908.2446" y1="159.4727" y2="159.4727"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="908.2446" y1="162.4727" y2="162.4727"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="275.5298" x="318.8574" y="148.9063"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="257.0039" x="324.8574" y="164.9731">Attack Vector 1: Filesystem Access</text><g class="message" data-participant-1="Attacker" data-participant-2="Host"><polygon fill="#000000" points="222.271,199.1719,232.271,203.1719,222.271,207.1719,226.271,203.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="49.6543" x2="228.271" y1="203.1719" y2="203.1719"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.6167" x="56.6543" y="198.106">Compromise host system</text></g><g class="message" data-participant-1="Attacker" data-participant-2="Env"><polygon fill="#000000" points="321.9326,228.3047,331.9326,232.3047,321.9326,236.3047,325.9326,232.3047" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="49.6543" x2="327.9326" y1="232.3047" y2="232.3047"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.375" x="56.6543" y="227.2388">Read .env file</text></g><g class="message" data-participant-1="Env" data-participant-2="Attacker"><polygon fill="#000000" points="60.6543,260.4375,50.6543,264.4375,60.6543,268.4375,56.6543,264.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="54.6543" x2="337.9326" y1="264.4375" y2="264.4375"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="233.4097" x="66.6543" y="259.3716">FRITZBOX_PASSWORD=SharedPass</text></g><path d="M348,245.3047 L348,270.3047 L525,270.3047 L525,255.3047 L515,245.3047 L348,245.3047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M515,245.3047 L515,255.3047 L525,255.3047 L515,245.3047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.5522" x="354" y="262.3716">All credentials exposed!</text><g class="message" data-participant-1="Attacker" data-participant-2="FB1"><polygon fill="#000000" points="523.8262,292.5703,533.8262,296.5703,523.8262,300.5703,527.8262,296.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="49.6543" x2="529.8262" y1="296.5703" y2="296.5703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146.5483" x="56.6543" y="291.5044">Login with SharedPass</text></g><g class="message" data-participant-1="FB1" data-participant-2="Attacker"><polygon fill="#000000" points="60.6543,324.7031,50.6543,328.7031,60.6543,332.7031,56.6543,328.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="54.6543" x2="539.8262" y1="328.7031" y2="328.7031"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.0137" x="66.6543" y="323.6372">Access granted</text></g><path d="M550,309.5703 L550,334.5703 L670,334.5703 L670,319.5703 L660,309.5703 L550,309.5703" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M660,309.5703 L660,319.5703 L670,319.5703 L660,309.5703" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.1567" x="556" y="326.6372">COMPROMISED</text><g class="message" data-participant-1="Attacker" data-participant-2="FB2"><polygon fill="#000000" points="637.457,356.8359,647.457,360.8359,637.457,364.8359,641.457,360.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="49.6543" x2="643.457" y1="360.8359" y2="360.8359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146.5483" x="56.6543" y="355.77">Login with SharedPass</text></g><g class="message" data-participant-1="FB2" data-participant-2="Attacker"><polygon fill="#000000" points="60.6543,388.9688,50.6543,392.9688,60.6543,396.9688,56.6543,392.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="54.6543" x2="653.457" y1="392.9688" y2="392.9688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.0137" x="66.6543" y="387.9028">Access granted</text></g><path d="M664,373.8359 L664,398.8359 L784,398.8359 L784,383.8359 L774,373.8359 L664,373.8359" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M774,373.8359 L774,383.8359 L784,383.8359 L774,373.8359" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.1567" x="670" y="390.9028">COMPROMISED</text><g class="message" data-participant-1="Attacker" data-participant-2="FB3"><polygon fill="#000000" points="751.0879,421.1016,761.0879,425.1016,751.0879,429.1016,755.0879,425.1016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="49.6543" x2="757.0879" y1="425.1016" y2="425.1016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146.5483" x="56.6543" y="420.0356">Login with SharedPass</text></g><g class="message" data-participant-1="FB3" data-participant-2="Attacker"><polygon fill="#000000" points="60.6543,453.2344,50.6543,457.2344,60.6543,461.2344,56.6543,457.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="54.6543" x2="767.0879" y1="457.2344" y2="457.2344"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.0137" x="66.6543" y="452.1685">Access granted</text></g><path d="M778,438.1016 L778,463.1016 L898,463.1016 L898,448.1016 L888,438.1016 L778,438.1016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M888,438.1016 L888,448.1016 L898,448.1016 L888,438.1016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.1567" x="784" y="455.1685">COMPROMISED</text><path d="M10,473.2344 L10,513.2344 L807,513.2344 L807,483.2344 L797,473.2344 L10,473.2344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M797,473.2344 L797,483.2344 L807,483.2344 L797,473.2344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="295.8516" x="233.9282" y="490.3013">BLAST RADIUS: All 3 Fritzboxes compromised</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="341.0469" x="233.9282" y="505.4341">Single credential leak = Complete network takeover</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="903.2446" x="5" y="539.0664"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="908.2446" y1="539.0664" y2="539.0664"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="908.2446" y1="542.0664" y2="542.0664"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="251.8022" x="330.7212" y="528.5"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="233.2764" x="336.7212" y="544.5669">Attack Vector 2: Docker Inspect</text><g class="message" data-participant-1="Attacker" data-participant-2="Docker"><polygon fill="#000000" points="420.251,578.7656,430.251,582.7656,420.251,586.7656,424.251,582.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="49.6543" x2="426.251" y1="582.7656" y2="582.7656"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184.9009" x="56.6543" y="577.6997">docker inspect infra-monitor</text></g><g class="message" data-participant-1="Docker" data-participant-2="Attacker"><polygon fill="#000000" points="60.6543,607.8984,50.6543,611.8984,60.6543,615.8984,56.6543,611.8984" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="54.6543" x2="436.251" y1="611.8984" y2="611.8984"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="192.2451" x="66.6543" y="606.8325">Env vars including passwords</text></g><path d="M54,624.8984 L54,679.8984 L226,679.8984 L226,634.8984 L216,624.8984 L54,624.8984" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M216,624.8984 L216,634.8984 L226,634.8984 L216,624.8984" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.6577" x="60" y="641.9653">Secrets visible in:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.3091" x="60" y="657.0981">- docker inspect output</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.4243" x="60" y="672.231">- /proc/PID/environ</text><!--SRC=[hLHDR-8m4BtxLqoxrsKHuHOfAmKeMgHM8DBzq6gbbKa6i4Zio3Pfkxz-nyOb2QXI3yq11RytVZDlPd9ZzrWXr2KNafc3a3NNl88DpmyxhOwocAfIQVWqzmzZLjWI8SFyg8LzWTHQOi8FpAtI9ePippKMCAKVb5RmqZ367HQOg1a9M96BcaiBjz-KiNzazc8iLhV03RY3FkKBoWRceaIFtycc3y-KkzLZfzS-FASq_stKCumyPJuPlO570O_UmCS17pEM9FswOHJx18ql0z8yHsCWIHXxBHe6Ntrb4CDKLRLMbJ08UtTo2d8cYOPRF1dG2wIIAMwDl03lnPQaMhupn346n3n7KJxhnUFloVBNtrMQPJ-NwrboQisA6yEaea0jTdlBW9wqB25lEmRuN2k3nGr3MO3ZiW9xUfs_r-cInQH_htP2mfEmU-W8dyDS7npn8kjWtKwJzrXqyYJVbW-hzV9XaTtDklhkeWlvw3to4NF43v2FBkN7xv4VCqVy07aQHyzJ3ROxzja3hhMJ-pHxX7KwMtpFOj_eCRoED1h8pyDOU7ecv8xMknq6A94V8F5JMoBfIBHFIX_0yWCwpNP6hjSYYiDAmaAQciwkTYB0CHId5n5uGcur7rHA2hgdzIqiU8YwSCyjGSEreU2yF1PK2TJaEcLRcAvduPAElQ2sxUV9su3aW3NG22Csv8UGiJyVNEQfZhO-se0DoSfyk5hCXhIbGYjvzkO_]--></g></svg>